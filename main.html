<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sandeep's Heart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&family=Allura&display=swap">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <style>
        /* CSS variables for night mode (default) */
        :root {
            --body-bg-color: #000000;
            --text-color: #ffffff;
            --button-bg-color: #1f2937;
            --glow-color-1: #ec4899; /* Default Pink */
            --glow-color-2: #f43f5e; /* Default Red */
            --button-gradient: linear-gradient(to right, var(--glow-color-1), var(--glow-color-2));
            --day-glow-color-1: #ff69b4;
            --day-glow-color-2: #ff1493;
            --day-button-gradient: linear-gradient(to right, var(--day-glow-color-1), var(--day-glow-color-2));

            /* Neon effect colors */
            --neon-glow-color-1: #00f0ff; /* Cyan */
            --neon-glow-color-2: #ff00ff; /* Magenta */
            --neon-shadow-1: 0 0 5px var(--neon-glow-color-1), 0 0 10px var(--neon-glow-color-1), 0 0 20px var(--neon-glow-color-1);
            --neon-shadow-2: 0 0 5px var(--neon-glow-color-2), 0 0 10px var(--neon-glow-color-2), 0 0 20px var(--neon-glow-color-2);
        }

        /* Day mode styles - will be applied when the 'day-mode' class is active */
        body.day-mode {
            --body-bg-color: #f3f4f6; /* Light gray */
            --text-color: #000000;
            --button-bg-color: var(--body-bg-color);
            --neon-glow-color-1: #00aaff; /* Lighter blue for day mode neon */
            --neon-glow-color-2: #ff6600; /* Orange for day mode neon */
            --neon-shadow-1: 0 0 5px var(--neon-glow-color-1), 0 0 10px var(--neon-glow-color-1), 0 0 20px var(--neon-glow-color-1);
            --neon-shadow-2: 0 0 5px var(--neon-glow-color-2), 0 0 10px var(--neon-glow-color-2), 0 0 20px var(--neon-glow-color-2);
        }

        body.day-mode footer,
        body.day-mode #main-content p {
            color: var(--text-color);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--body-bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            text-align: center;
            transition: background-color 0.5s ease-in-out, color 0.5s ease-in-out;
        }

        #threeCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            transition: opacity 0.5s ease-in-out;
        }

        body.day-mode #threeCanvas {
            opacity: 0;
        }

        #dayBackground {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background-color: #87CEEB;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        body.day-mode #dayBackground {
            opacity: 1;
        }

        #main-content {
            width: 100%;
            max-width: 100%;
            display: flex;
            flex-direction: column; /* Default to column for mobile */
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            padding: 2rem;
            gap: 1rem; /* Reduced gap */
        }

        .main-title {
            font-family: 'Allura', cursive;
            animation: text-glow 4s ease-in-out infinite, fade-in 1s ease-in-out forwards;
            text-align: center;
            color: var(--glow-color-1); /* Default pink color */
            text-shadow: 0 0 5px var(--glow-color-1), 0 0 10px var(--glow-color-1), 0 0 15px var(--glow-color-1); /* Default pink glow */
            opacity: 0;
        }

        #main-content p {
            animation: fade-in 1s ease-in-out forwards;
            animation-delay: 0.5s;
            opacity: 0;
        }

        @keyframes text-glow {
            0%, 100% {
                text-shadow: 0 0 5px var(--glow-color-1), 0 0 10px var(--glow-color-1), 0 0 15px var(--glow-color-1);
            }
            50% {
                text-shadow: 0 0 10px var(--glow-color-2), 0 0 20px var(--glow-color-2), 0 0 30px var(--glow-color-2);
            }
        }

        @keyframes fade-in {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .heart-video {
            width: 100%;
            height: auto;
            border-radius: 1rem;
            box-shadow: 0 0 10px var(--glow-color-1), 0 0 20px var(--glow-color-2);
            transition: box-shadow 0.5s ease-in-out;
            border: 2px solid transparent;
            background-image: linear-gradient(to right, #1f2937, #1f2937), var(--button-gradient);
            background-origin: border-box;
            background-clip: content-box, border-box;
            object-fit: cover;
        }

        @media (min-width: 768px) {
            .heart-video {
                max-width: 800px;
            }
        }

        .svg-heart {
            width: 80px;
            height: 80px;
            margin-bottom: 1rem;
            fill: url(#heart-gradient);
            animation: heart-pulse 1.5s ease-in-out infinite, heart-glow 4s ease-in-out infinite;
        }

        @keyframes heart-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        @keyframes heart-glow {
            0%, 100% { filter: drop-shadow(0 0 5px var(--glow-color-1)) drop-shadow(0 0 10px var(--glow-color-1)); }
            50% { filter: drop-shadow(0 0 10px var(--glow-color-2)) drop-shadow(0 0 20px var(--glow-color-2)); }
        }

        .shooting-star {
            position: absolute;
            background: linear-gradient(to right, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0));
            border-radius: 50%;
            height: 2px;
            pointer-events: none;
            opacity: 0;
            animation: star-fall linear infinite;
        }
        @keyframes star-fall {
            0% { opacity: 0; transform: rotate(-45deg) translateX(0); }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; transform: rotate(-45deg) translateX(400px); }
        }

        .color-picker-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .color-picker-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            background-color: #1f2937;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
            transition: background-color 0.5s ease-in-out;
        }

        body.day-mode .color-picker-group {
            background-color: var(--body-bg-color);
        }

        .color-picker {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 2rem;
            height: 2rem;
            background-color: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            overflow: hidden;
        }

        .color-picker::-webkit-color-swatch-wrapper {
            padding: 0;
        }

        .color-picker::-webkit-color-swatch {
            border: none;
            border-radius: 50%;
        }
        .color-picker::-moz-color-swatch {
            border: none;
            border-radius: 50%;
        }

        .button-group button {
            border: 2px solid transparent;
            background-image: linear-gradient(var(--button-bg-color), var(--button-bg-color)), var(--button-gradient);
            background-origin: border-box;
            background-clip: padding-box, border-box;
            transition: transform 0.2s, box-shadow 0.2s, background-image 0.5s, color 0.5s;
            padding: 0.4rem 1rem;
            font-size: 0.9rem;
            box-shadow: 0 0 10px var(--neon-glow-color-1);
        }

        .button-group button:hover {
            box-shadow: 0 0 15px var(--neon-glow-color-1), 0 0 25px var(--neon-glow-color-2);
        }

        body.day-mode .button-group button {
            color: #000000;
        }

        body:not(.day-mode) .button-group button {
            color: #ffffff;
        }

        .button-group button:hover {
            animation: button-pop 0.3s forwards;
            box-shadow: 0 0 15px var(--glow-color-1), 0 0 25px var(--glow-color-2);
        }
        .button-group button:active {
            transform: scale(0.95);
        }
        @keyframes button-pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1.05); }
        }

        #day-night-toggle {
            position: fixed;
            top: 2rem;
            right: calc(2rem + 1vw);
            z-index: 1000;
            cursor: pointer;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid var(--text-color);
            background-color: var(--button-bg-color);
            transition: background-color 0.5s ease-in-out, border-color 0.5s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px var(--glow-color-1);
        }

        #day-night-toggle svg {
            width: 24px;
            height: 24px;
            fill: var(--text-color);
            transition: fill 0.5s ease-in-out;
        }

        .theme-wipe {
            position: fixed;
            border-radius: 50%;
            z-index: 9999;
            pointer-events: none;
            opacity: 1;
            transform: scale(0) translate(-50%, -50%);
            animation: theme-wipe 0.6s cubic-bezier(0.8, 0.2, 0.2, 0.8) forwards;
        }

        @keyframes theme-wipe {
            from { transform: scale(0) translate(-50%, -50%); }
            to { transform: scale(200) translate(-50%, -50%); }
        }

        .light-bloom {
            position: fixed;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 999;
            animation: bloom-fade-out 0.8s ease-out forwards;
        }

        @keyframes bloom-fade-out {
            0% {
                width: 0; height: 0; opacity: 1;
                box-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 40px currentColor;
            }
            100% {
                width: 200px; height: 200px; opacity: 0;
                box-shadow: 0 0 50px currentColor, 0 0 100px currentColor, 0 0 150px currentColor;
            }
        }

        #message-box {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(45, 212, 191, 0.9);
            color: white;
            padding: 1rem 2rem;
            border-radius: 9999px;
            box-shadow: 0 4px 15px rgba(45, 212, 191, 0.4);
            transition: opacity 0.5s ease-in-out;
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
        }

        /* Tab specific styles */
        .tab-buttons {
            display: flex;
            justify-content: center;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-radius: 9999px;
            overflow: hidden;
            box-shadow: var(--neon-shadow-1);
            border: 2px solid var(--glow-color-1);
            background-origin: border-box;
            background-clip: padding-box, border-box;
            position: relative;
            z-index: 1;
            transition: box-shadow 0.3s ease-in-out, border-image 0.3s ease-in-out;
        }

        .tab-buttons.active-neon {
            box-shadow: var(--neon-shadow-1); /* Neon glow for the active tab bar */
            border-image: linear-gradient(to right, var(--neon-glow-color-1), var(--neon-glow-color-2)) 1;
        }

        .tab-button {
            background-color: var(--button-bg-color);
            color: var(--text-color);
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s, text-shadow 0.3s;
            border: none; /* Remove individual button borders */
            flex-grow: 1;
            text-align: center;
            white-space: nowrap;
        }

        /* Apply specific border-radius to first and last buttons */
        .tab-button:first-child {
            border-top-left-radius: 9999px;
            border-bottom-left-radius: 9999px;
        }

        .tab-button:last-child {
            border-top-right-radius: 9999px;
            border-bottom-right-radius: 9999px;
        }

        /* Add a right border to all but the last button for separation */
        .tab-button:not(:last-child) {
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }

        .tab-button:hover {
            color: var(--neon-glow-color-1);
            text-shadow: 0 0 5px var(--neon-glow-color-1); /* Subtle text glow on hover */
        }

        .tab-button.active {
            background-image: var(--button-gradient);
            color: white;
            text-shadow: 0 0 5px white; /* Subtle text glow for active button */
        }

        body.day-mode .tab-button.active {
            background-image: var(--day-button-gradient);
            color: black;
            text-shadow: 0 0 5px black;
        }

        .tab-content {
            display: flex; /* Always flex for layout */
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            width: 100%;
            max-width: 800px;
            padding: 1rem;
            background-color: var(--button-bg-color);
            border-radius: 1rem;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
            transition: background-color 0.5s ease-in-out, opacity 0.3s ease-in-out, height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
            overflow: hidden; /* Hide content when height is 0 */
        }

        body.day-mode .tab-content {
            background-color: var(--body-bg-color);
        }

        .tab-content:not(.active) {
            opacity: 0;
            height: 0;
            padding: 0;
            margin: 0;
            pointer-events: none; /* Prevent interaction when inactive */
        }

        .tab-content.active {
            opacity: 1;
            height: auto; /* Allow content to take its natural height */
            padding: 1rem;
            margin-top: 1rem; /* Add some space above active tab content */
            pointer-events: auto;
        }

        /* Mobile-specific layout */
        @media (max-width: 767px) {
            #main-content {
                flex-direction: column; /* Stack elements vertically */
            }

            .tabs-section {
                order: 0; /* Tabs at the top */
                width: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            #animation-container {
                order: 1; /* Animation at the bottom */
                width: 100%;
                margin-top: 2rem; /* Space between tabs content and video */
            }

            /* On mobile, animation-content is always visible (can be scrolled to) */
            #animation-content {
                opacity: 1; /* Always visible (can be scrolled to) */
                height: auto;
                padding: 1rem;
                margin-top: 1rem; /* Add some space above video */
                pointer-events: auto;
            }

            /* When animation tab is NOT active, it should still be scrollable */
            #animation-content:not(.active) {
                /* Keep it visible and scrollable, but not "active" in the tab sense */
                opacity: 1;
                height: auto;
                padding: 1rem;
                margin-top: 1rem;
                pointer-events: auto;
            }
        }

        /* Laptop/Desktop Layout */
        @media (min-width: 768px) {
            #main-content {
                flex-direction: row; /* Arrange elements horizontally */
                align-items: flex-start; /* Align items to the top */
                justify-content: center;
                gap: 2rem; /* Space between video and tabs */
                max-width: 1200px; /* Increase max-width for desktop layout */
            }

            #animation-container {
                flex: 1; /* Take up available space */
                display: flex;
                justify-content: center;
                align-items: center;
                min-width: 400px; /* Minimum width for the video section */
                max-width: 50%; /* Max width for the video section */
                order: 0; /* Animation on the left */
                margin-top: 0; /* Remove mobile margin */
            }

            .heart-video {
                width: 100%;
                max-width: 600px; /* Adjust video size for desktop */
                height: auto;
            }

            .tabs-section {
                flex: 1; /* Take up available space */
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 400px; /* Minimum width for the tabs section */
                max-width: 50%; /* Max width for the tabs section */
                order: 1; /* Tabs section on the right */
            }

            .tab-buttons {
                width: 100%;
                max-width: 500px; /* Limit tab button width */
            }

            .tab-content {
                width: 100%;
                max-width: 500px; /* Limit tab content width */
            }

            /* On desktop, animation-content is always visible and active */
            #animation-content {
                opacity: 1;
                height: auto;
                padding: 0; /* Remove padding from this specific content div */
                background-color: transparent; /* No background for this content div */
                box-shadow: none; /* No shadow for this content div */
                pointer-events: auto;
                margin-top: 0; /* Remove mobile margin */
            }
        }
    </style>
</head>
<body class="bg-black text-white">
    <script>
        // Check if the user is coming from the index page.
        const fromIndex = sessionStorage.getItem('fromIndex');
        if (fromIndex !== 'true') {
            // If the flag is not set, redirect to the landing page.
            window.location.href = 'index.html';
        } else {
            // If the flag is set, clear it immediately so that a page refresh
            // will cause a redirection back to index.html.
            sessionStorage.removeItem('fromIndex');
        }
    </script>

    <div id="dayBackground"></div>
    <div id="threeCanvas"></div>

    <button id="day-night-toggle">
        <svg class="sun hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
    </button>

    <main id="main-content" class="content-container mx-auto flex-grow flex flex-col items-center justify-center">
        <svg class="svg-heart" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <linearGradient id="heart-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:rgb(236,72,153);stop-opacity:1" />
                    <stop offset="100%" style="stop-color:rgb(244,63,94);stop-opacity:1" />
                </linearGradient>
            </defs>
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>

        <h1 class="main-title text-5xl sm:text-6xl font-extrabold mb-4 tracking-tight leading-tight">
            Sandeep's Heart
        </h1>
        <p class="text-lg sm:text-xl text-gray-300 max-w-2xl">
            Welcome to the main section of Sandeep's Heart.
        </p>

        <!-- Tabs Section (contains buttons and tab content) -->
        <div class="tabs-section">
            <!-- Tab Buttons -->
            <div class="tab-buttons">
                <button class="tab-button active" data-tab="animation">Animation</button>
                <button class="tab-button" data-tab="edit">Edit</button>
                <button class="tab-button" data-tab="about">About the project</button>
            </div>

            <!-- Tab Content - Edit -->
            <div id="edit-content" class="tab-content">
                <div class="color-picker-container">
                    <div class="color-picker-group">
                        <label for="color1" class="text-white">Glow Color 1:</label>
                        <input type="color" id="color1" class="color-picker" value="#ec4899">
                    </div>
                    <div class="color-picker-group">
                        <label for="color2" class="text-white">Glow Color 2:</label>
                        <input type="color" id="color2" class="color-picker" value="#f43f5e">
                    </div>
                </div>
                <div class="flex flex-row space-x-4 button-group">
                    <button id="change-color-btn" class="color-button font-bold py-2 px-6 rounded-full shadow-lg">
                        Random Color
                    </button>
                    <button id="share-btn" class="color-button font-bold py-2 px-6 rounded-full shadow-lg">
                        Share
                    </button>
                </div>
            </div>

            <!-- Tab Content - About the project -->
            <div id="about-content" class="tab-content">
                <p class="text-white">This project is a tribute to Sandeep. It features a dynamic background with a 3D starfield, interactive glow effects, and customizable colors. The heart animation symbolizes the core theme of the project.</p>
                <p class="text-white">Feel free to explore the different sections and customize the glow colors to your liking!</p>
            </div>
        </div>

        <!-- Animation Container (for video) -->
        <div id="animation-container">
            <!-- Tab Content - Animation -->
            <div id="animation-content" class="tab-content">
                <video class="heart-video" autoplay loop muted playsinline>
                    <source src="https://raw.githubusercontent.com/gsgsjssvsv1249/radharanii/main/heart.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>

    </main>

    <div id="message-box" role="status">
        URL copied to clipboard!
    </div>

    <footer class="w-full text-center text-gray-500 z-10 relative">
        <p class="text-sm">
            Built by <a href="https://t.me/HackerXBhai" class="text-blue-400 hover:underline">@HackerXBhai</a>. The source code is available on <a href="https://t.me/HackerXBhai" class="text-blue-400 hover:underline">Telegram</a>.
        </p>
    </footer>

    <script>
        // --- Core Page Logic ---
        const colorBtn = document.getElementById('change-color-btn');
        const shareBtn = document.getElementById('share-btn');
        const messageBox = document.getElementById('message-box');
        const dayNightToggleBtn = document.getElementById('day-night-toggle');
        const body = document.body;
        const mainContent = document.getElementById('main-content');

        // Color picker elements
        const color1Input = document.getElementById('color1');
        const color2Input = document.getElementById('color2');

        // Tab elements
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabButtonsContainer = document.querySelector('.tab-buttons'); // Get the container
        const tabContents = document.querySelectorAll('.tab-content');
        const animationContent = document.getElementById('animation-content');
        const heartVideo = document.querySelector('#animation-content .heart-video');

        // Function to update all colors based on the chosen palette
        function updateColors(glow1, glow2) {
            const root = document.documentElement;
            const isDayMode = body.classList.contains('day-mode');

            // Set the main glow and gradient colors based on the mode
            root.style.setProperty('--glow-color-1', glow1);
            root.style.setProperty('--glow-color-2', glow2);
            root.style.setProperty('--button-gradient', `linear-gradient(to right, ${glow1}, ${glow2})`);

            // Also update the SVG heart gradient
            const svgHeartDefs = document.getElementById('heart-gradient');
            if (svgHeartDefs) {
                const stops = svgHeartDefs.querySelectorAll('stop');
                stops[0].style.stopColor = glow1;
                stops[1].style.stopColor = glow2;
            }

            // Update day mode specific gradients if needed
            if (isDayMode) {
                // You can add more logic here to handle different colors for day mode
                // For now, it will use the same glow colors for day mode buttons
                root.style.setProperty('--day-glow-color-1', glow1);
                root.style.setProperty('--day-glow-color-2', glow2);
                root.style.setProperty('--day-button-gradient', `linear-gradient(to right, ${glow1}, ${glow2})`);
            }
        }

        // Function to generate a random hex color
        function getRandomHexColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        // Handle color picker input changes
        function handleColorChange() {
            const glow1 = color1Input.value;
            const glow2 = color2Input.value;
            updateColors(glow1, glow2);
        }

        // Function to toggle between day and night mode with a circular wipe animation
        function toggleDayNightMode(event) {
            const isDayMode = body.classList.contains('day-mode');

            const wipe = document.createElement('div');
            wipe.classList.add('theme-wipe');

            const targetColor = isDayMode ? '#000000' : '#f3f4f6';
            wipe.style.backgroundColor = targetColor;

            const rect = dayNightToggleBtn.getBoundingClientRect();
            wipe.style.top = `${rect.top + rect.height / 2}px`;
            wipe.style.left = `${rect.left + rect.width / 2}px`;

            document.body.appendChild(wipe);

            setTimeout(() => {
                body.classList.toggle('day-mode');
                const sunIcon = dayNightToggleBtn.querySelector('.sun');
                const moonIcon = dayNightToggleBtn.querySelector('.moon');

                if (body.classList.contains('day-mode')) {
                    sunIcon.classList.remove('hidden');
                    moonIcon.classList.add('hidden');
                } else {
                    sunIcon.classList.add('hidden');
                    moonIcon.classList.remove('hidden');
                }

                // Reapply colors to handle day/night mode specific changes
                updateColors(color1Input.value, color2Input.value);
            }, 300); // Half of the animation duration

            wipe.addEventListener('animationend', () => {
                wipe.remove();
            });
        }

        function createLightBloom(x, y) {
            if (!body.classList.contains('day-mode')) {
                return;
            }
            const bloom = document.createElement('div');
            bloom.classList.add('light-bloom');
            bloom.style.top = `${y}px`;
            bloom.style.left = `${x}px`;
            bloom.style.color = color1Input.value; // Use currentColor to pass the glow color
            document.body.appendChild(bloom);

            setTimeout(() => {
                bloom.remove();
            }, 800);
        }

        // Event listener for the day/night toggle button
        if (dayNightToggleBtn) {
            dayNightToggleBtn.addEventListener('click', toggleDayNightMode);
        }

        // Event listener for the "Random Color" button
        if (colorBtn) {
            colorBtn.addEventListener('click', () => {
                const randomColor1 = getRandomHexColor();
                const randomColor2 = getRandomHexColor();
                color1Input.value = randomColor1;
                color2Input.value = randomColor2;
                updateColors(randomColor1, randomColor2);
            });
        }

        // Event listeners for color picker inputs
        if (color1Input && color2Input) {
            color1Input.addEventListener('input', handleColorChange);
            color2Input.addEventListener('input', handleColorChange);
        }

        document.addEventListener('click', (event) => {
            createLightBloom(event.clientX, event.clientY);
        });

        if (shareBtn) {
            shareBtn.addEventListener('click', () => {
                if (navigator.share) {
                    navigator.share({
                        title: 'Sandeep\'s Heart',
                        text: 'Welcome to the main section of Sandeep\'s Heart.',
                        url: window.location.href
                    }).then(() => {
                        messageBox.textContent = 'Shared successfully!';
                        messageBox.style.backgroundColor = 'rgba(45, 212, 191, 0.9)';
                        messageBox.style.opacity = '1';
                        setTimeout(() => { messageBox.style.opacity = '0'; }, 3000);
                    }).catch((error) => {
                        console.error('Sharing failed:', error);
                        messageBox.textContent = 'Sharing cancelled or failed.';
                        messageBox.style.backgroundColor = 'rgba(239, 68, 68, 0.9)';
                        messageBox.style.opacity = '1';
                        setTimeout(() => { messageBox.style.opacity = '0'; }, 3000);
                    });
                } else {
                    const url = window.location.href;
                    const textarea = document.createElement('textarea');
                    textarea.value = url;
                    document.body.appendChild(textarea);
                    textarea.select();
                    try {
                        document.execCommand('copy');
                        messageBox.textContent = 'URL copied to clipboard!';
                        messageBox.style.backgroundColor = 'rgba(45, 212, 191, 0.9)';
                    } catch (err) {
                        messageBox.textContent = 'Failed to copy URL.';
                        messageBox.style.backgroundColor = 'rgba(239, 68, 68, 0.9)';
                    }
                    document.body.removeChild(textarea);
                    messageBox.style.opacity = '1';
                    setTimeout(() => { messageBox.style.opacity = '0'; }, 3000);
                }
            });
        }

        // --- 3D Starfield Background Script with Three.js ---
        let scene, camera, renderer, starGeo, stars;
        let mouseX = 0, mouseY = 0;

        function initThreeJS() {
            if (!THREE) {
                console.error('Three.js library is not loaded.');
                return;
            }

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 1, 1000);
            camera.position.z = 1;
            camera.rotation.x = Math.PI / 2;

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.domElement.style.position = 'fixed';
            renderer.domElement.style.top = '0';
            renderer.domElement.style.left = '0';
            renderer.domElement.style.zIndex = '-1';
            document.getElementById('threeCanvas').appendChild(renderer.domElement);

            starGeo = new THREE.BufferGeometry();
            const starCount = 10000;
            const positions = [];
            const velocities = [];
            for (let i = 0; i < starCount; i++) {
                positions.push((Math.random() - 0.5) * 600, (Math.random() - 0.5) * 600, (Math.random() - 0.5) * 600);
                velocities.push(0, 0, Math.random() * 0.2 + 0.1);
            }
            starGeo.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            starGeo.setAttribute('velocity', new THREE.Float32BufferAttribute(velocities, 3));

            const starMaterial = new THREE.PointsMaterial({
                color: 0xaaaaaa,
                size: 1.0,
                transparent: true,
                opacity: 0.9
            });

            stars = new THREE.Points(starGeo, starMaterial);
            scene.add(stars);

            window.addEventListener('mousemove', onMouseMove, false);
            window.addEventListener('resize', onWindowResize, false);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function onMouseMove(event) {
            mouseX = (event.clientX / window.innerWidth) * 2 - 1;
            mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
        }

        function createShootingStar() {
            const star = document.createElement('div');
            star.classList.add('shooting-star');
            star.style.width = `${Math.random() * 50 + 50}px`;
            star.style.top = `${Math.random() * window.innerHeight}px`;
            star.style.left = `${Math.random() * window.innerWidth}px`;
            star.style.animationDuration = `${Math.random() * 2 + 1}s`;
            star.style.animationDelay = `${Math.random() * 2}s`;
            document.body.appendChild(star);

            setTimeout(() => {
                star.remove();
            }, (Math.random() * 2 + 1) * 1000 + (Math.random() * 2) * 1000);
        }

        // --- Animation Loop ---
        function animate() {
            requestAnimationFrame(animate);

            if (!body.classList.contains('day-mode')) {
                const positions = starGeo.attributes.position.array;
                const velocities = starGeo.attributes.velocity.array;
                for (let i = 0; i < positions.length; i += 3) {
                    positions[i + 2] += velocities[i + 2];
                    if (positions[i + 2] > camera.position.z) {
                        positions[i + 2] = -600;
                        velocities[i + 2] = Math.random() * 0.2 + 0.1;
                    }
                }
                starGeo.attributes.position.needsUpdate = true;

                camera.position.x += (mouseX * 0.5 - camera.position.x) * 0.05;
                camera.position.y += (mouseY * 0.5 - camera.position.y) * 0.05;
                camera.lookAt(scene.position);

                renderer.render(scene, camera);
            }
        }

        // --- Tab Functionality ---
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetTab = button.dataset.tab;

                // Deactivate all tab buttons
                tabButtons.forEach(btn => btn.classList.remove('active'));

                // Hide all tab contents
                tabContents.forEach(content => {
                    content.classList.remove('active');
                });

                // Activate the clicked button
                button.classList.add('active');

                // Show the target tab content
                const targetContent = document.getElementById(`${targetTab}-content`);
                if (targetContent) {
                    targetContent.classList.add('active');
                }

                // Always play video and show neon glow
                if (heartVideo) {
                    heartVideo.play();
                }
                tabButtonsContainer.classList.add('active-neon');

                // On desktop, animation content is always visible and playing
                if (window.innerWidth >= 768) {
                    animationContent.classList.add('active'); // Ensure it's active for desktop layout
                    if (heartVideo) {
                        heartVideo.play(); // Ensure video plays on desktop regardless of tab
                    }
                }
            });
        });


        window.onload = function() {
            initThreeJS();
            animate();
            setInterval(createShootingStar, 5000);
            updateColors(color1Input.value, color2Input.value);

            // Set initial active tab
            // On mobile, default to animation tab
            if (window.innerWidth < 768) {
                document.querySelector('.tab-button[data-tab="animation"]').click();
            } else {
                // On desktop, default to animation tab, and ensure video is always playing
                document.querySelector('.tab-button[data-tab="animation"]').click();
                // Ensure animation content is always active and visible on desktop
                animationContent.classList.add('active');
                if (heartVideo) {
                    heartVideo.play();
                }
            }
        };
    </script>
</body>
</html>
